# Values, Types, and Operators

在计算机世界中，只有数据。 您可以读取数据，修改数据，创建新数据，但不能提及不是数据的数据。 所有这些数据都存储为长序列，因此从根本上是相似的。

bits是任何类型的二值事物，通常描述为零和一。 在计算机内部，它们采取诸如高电荷或低电荷，强信号或弱信号或CD表面上的亮点或暗点之类的形式。 任何离散信息都可以简化为零和一的序列，从而以位表示。

例如，我们可以用位表示数字13。 它的工作方式与十进制数字相同，但您只有2个，而不是10个不同的数字，每个数字的权重从右到左增加了2倍。 这是组成数字13的位，其下方显示的是数字的权重：

| 0    | 0    | 0    | 0    | 1    | 1    | 0    | 1    |
| :--- | ---- | ---- | ---- | ---- | ---- | ---- | ---- |
| 128  | 64   | 32   | 16   | 8    | 4    | 2    | 1    |

这就是二进制数字00001101。它的非零数字代表8、4和1，加起来等于13。

## Values

想象一下，bit的海洋。 典型的现代计算机的易失性数据存储（工作内存）中有超过300亿位。 非易失性存储（硬盘或同等存储）往往要多几个数量级。

为了能够处理如此大量的比特而不会丢失，我们必须将它们分成代表信息的块。 在JavaScript环境中，这些块称为值。 尽管所有值都是由位组成的，但它们起着不同的作用。 每个值都有一个确定其作用的类型。 有些值是数字，有些值是文本，有些值是函数，依此类推。

要创建一个值，您仅需调用其名称。 这很方便。 您无需为值收集构建材料，您只需要调用一个，然后就可以了。 当然，它们并不是真正凭空创造的。 每个值都必须存储在某个位置，如果您想同时使用大量的值，那么可能会用光内存。 幸运的是，仅当您同时需要它们时，这才是问题。 一旦不再使用某个值，它就会消散，留下的位将作为下一代值的构建材料被回收。

本章介绍了JavaScript程序的原子元素，即简单的值类型和可以对这些值进行操作的运算符。

## Numbers

毫无疑问，数字类型的值是数字值。 在JavaScript程序中，它们编写如下：

```c++
13
```

Use that in a program, and it will cause the bit pattern for the number 13 to come into existence inside the computer’s memory.

JavaScript使用固定数量的位（其中64位）来存储单个数字值。 64位可以制作的数字的个数是有限的，这意味着可以表示的不同数字的数量是有限的。 使用N个十进制数字，您可以表示10个N数字。 类似地，给定64个二进制数字，您可以表示2 64个不同的数字，大约为18百万分之十（一个18后加18个零）。 好多啊。

过去，计算机内存要小得多，人们倾向于使用8位或16位的组来表示其数字。 这么小的数字很容易意外地溢出-最终得到的数字不适合给定的位数。 如今，即使您的口袋计算机也有足够的内存，因此您可以自由使用64位块，并且仅在处理真正的天文数字时才需要担心溢出。

不过，并非所有小于18位数的整数都适合JavaScript编号。 这些位还存储负数，因此一位指示数字的符号。 更大的问题是非整数也必须表示出来。 为此，某些位用于存储小数点的位置。 可以存储的实际最大整数更多在9兆个（15个零）的范围内-这样的结果仍然令人满意。

小数点是使用点写的。

```c++
9.81
```

对于非常大或非常小的数字，您还可以使用科学计数法，方法是在数字的指数后面加上e（代表指数）。

```c++
2.998e8
```

$$
2.998\times10^{8}=299800000
$$

整数（也称为整数）小于上述9个四十进制的计算保证始终精确。 不幸的是，通常没有分数的计算。 正如无法用有限数量的十进制数字精确地表示π（pi）一样，当只有64位可用于存储它们时，许多数字会失去一些精度。 这是一个耻辱，但仅在特定情况下会引起实际问题。 重要的是要意识到这一点，并将分数数字视为近似值，而不是精确值。

### Arithmetic

与数字有关的主要事情是算术。 诸如加法或乘法之类的算术运算采用两个数字值，并从中产生一个新数字。 这是它们在JavaScript中的外观：
$$
100 + 4 * 11
$$
"+"和"*"符号被称作操作符。第一个代表加法，第二个代表乘法。 将运算符放在两个值之间会将其应用于这些值并产生一个新值。

但是该示例的意思是“将4和100相加，然后将结果乘以11”，还是在相加之前完成相乘？ 您可能已经猜到了，乘法首先发生。 但是，就像在数学中一样，您可以通过在括号中加上加法来更改此设置。
$$
(100+4)*11
$$
对于减法，可以使用-运算符，并且可以使用/运算符进行除法。

当运算符一起出现而没有括号时，它们的应用顺序由运算符的优先级确定。 该示例显示乘法先于加法。 /运算符的优先级与*相同。 对于+和-同样。 当多个具有相同优先级的运算符并排出现时（如1-2 + 1），它们从左到右应用：（1-2）+ 1。

您不必担心这些优先规则。 如有疑问，只需加上括号即可。

还有一个算术运算符，您可能不会立即意识到。 ％符号用于表示余数运算。 X％Y是X除以Y的余数。 例如，314％100产生14，而144％12产生0。 余数运算符的优先级与乘法和除法的优先级相同。 您还会经常看到此运算符称为“模”。

### 特殊数字

JavaScript中有三个特殊的值被认为是数字，但其行为不像普通数字。

前两个是Infinity和-Infinity，分别代表正无穷大。 Infinity-1仍然是Infinity，依此类推。 不过，不要对基于无穷大的计算过于信任。 从数学上讲，这不是很好，它会很快导致下一个特殊数字：NaN。

NaN代表“不是数字”，即使它是数字类型的值也是如此。 例如，当您尝试计算0/0（零除以零），Infinity-Infinity或任何其他无法产生有意义结果的数字运算时，都会得到此结果。

## 字符串

下一个基本数据类型是字符串。 字符串用于表示文本。 它们是通过将其内容括在引号中来编写的。

```javascript
`Down on the sea`
"Lie on the ocean"
'Float on the ocean'
```

您可以使用单引号，双引号或反引号来标记字符串，只要字符串开头和结尾的引号都匹配即可。

几乎所有的东西都可以放在引号之间，JavaScript将从中产生一个字符串值。 但是几个字符会更困难。 您可以想象将引号放在引号之间可能很难。 仅当字符串用反引号（\）引起来时，才可以包含换行符（按Enter时得到的字符）而不会转义。

为了使这样的字符可以包含在字符串中，使用以下表示法：只要在加引号的文本内发现反斜杠（\），就表示该字符之后的字符具有特殊含义。 这称为转义字符。 以反斜杠开头的引号不会结束字符串，而是字符串的一部分。 当反斜杠后出现n字符时，它将被解释为换行符。 同样，反斜杠后的t表示制表符。 采取以下字符串：

```javascript
"This is the first line\nAnd this is the second"
```

包含的实际文本是这样的：

```javascript
This is the first line
And this is the second
```

当然，在某些情况下，您希望字符串中的反斜杠只是反斜杠，而不是特殊代码。 如果两个反斜杠紧接着，它们将一起折叠，并且在结果字符串值中仅剩一个反斜杠。 这就是字符串“换行符如“ \ n”的书写方式。” 可以表示为：

```javascript
"A newline character is written like \"\\n\"."
```

字符串也必须建模为一系列位，才能在计算机内部存在。 JavaScript执行此操作的方式基于Unicode标准。 该标准几乎为您将需要的每个字符分配了一个数字，包括希腊语，阿拉伯语，日语，亚美尼亚语等的字符。 如果每个字符都有一个数字，则可以用一个数字序列来描述一个字符串。

这就是JavaScript所做的。 但这很复杂：JavaScript的表示形式每个字符串元素使用16位，最多可以描述2个16个不同的字符。 但是Unicode定义的字符要多得多，目前大约是字符的两倍。 因此，某些字符（例如许多表情符号）在JavaScript字符串中占据了两个“字符位置”。 我们将在第5章中回到这一点。

字符串不能被除，乘或减，但是可以对它们使用+运算符。 它不会添加，但会串联起来，将两个字符串粘合在一起。 以下行将产生字符串“ concatenate”：

```javascript
"con" + "cat" + "e" + "nate"
```

字符串值具有许多关联的函数（方法），可用于对它们执行其他操作。 我将在第4章中详细介绍这些内容。

用单引号或双引号引起来的字符串的行为几乎相同，唯一的区别在于您需要在引号中转义哪种类型。 用反引号引起来的字符串（通常称为模板文字）可以做更多的技巧。 除了能够跨越线外，它们还可以嵌入其他值。

```javascript
`half of 100 is ${100 / 2}`
```

当您在模板文字中的$ {}中写入内容时，其结果将被计算，转换为字符串并包含在该位置。 该示例产生“half of 100 is 50”。

## Unary Operators

并非所有运算符都是符号。 有些被写成文字。 一个示例是typeof运算符，该运算符生成一个字符串值，该字符串值提供值的类型名称。

```javascript
console.log(typeof 4.5)
// → number
console.log(typeof "x")
// → string
```

我们将在示例代码中使用console.log来表明我们希望查看评估结果。 下一章将详细介绍。

显示的其他运算符都对两个值进行运算，但是typeof只对一个进行运算。 使用两个值的运算符称为二元运算符，而使用一个值的运算符称为一元运算符。 负运算符既可以用作二进制运算符，也可以用作一元运算符。

```javascript
console.log(- (10 - 2))
// → -8
```

## Boolean Values

具有仅区分两个可能性（例如“是”和“否”或“打开”和“关闭”）的值通常很有用。 为此，JavaScript具有布尔类型，它只有两个值true和false，它们被写为这些单词。

### Comparison

这是产生布尔值的一种方法：

```javascript
console.log(3 > 2)
// → true
console.log(3 < 2)
// → false
```

“>”和“ <”分别是“大于”和“小于”的传统符号。 它们是二进制运算符。 应用它们会产生一个布尔值，该值指示在这种情况下它们是否成立。

字符串可以用相同的方式进行比较。

```javascript
console.log("Aardvark" < "Zoroaster")
// → true
```

字符串的排序方式大致是字母顺序的，但实际上并不是您期望在字典中看到的：大写字母总是比小写字母“小”，因此，“ Z” 小于“ a”，而且非字母字符（！，-， 等等）也包含在字母顺序中。 比较字符串时，JavaScript从左到右遍历字符，一一比较Unicode代码。

其他类似的运算符是> =（大于或等于），<=（小于或等于），==（等于）和！=（不等于）。

```javascript
console.log("Itchy" != "Scratchy")
// → true
console.log("Apple" == "Orange")
// → false
```

JavaScript中只有一个不等于自身的值，即NaN（“非数字”）。

```javascript
console.log(NaN == NaN)
// → false
```

NaN应该表示无意义的计算结果，因此，它不等于任何其他无意义的计算结果。

### Logical Operators

本身也可以将某些操作应用于布尔值。 JavaScript支持三种逻辑运算符：与，或，和 非。 这些可用于“推理”布尔值。

&&运算符表示逻辑与。 它是一个二进制运算符，并且仅当赋给它的两个值都为true时，其结果才为true。

```javascript
console.log(true && false)
// → false
console.log(true && true)
// → true
```

|| 运算符表示逻辑或。 如果给定的任何一个值为true，则它会生成true。

```javascript
console.log(false || true)
// → true
console.log(false || false)
// → false
```

非运算写为感叹号（！）。 这是一个一元运算符，它翻转赋予它的值。！true产生false，！false产生true。

将这些布尔运算符与算术运算符和其他运算符混合使用时，需要括号时并不总是很明显。 在实践中，通常可以了解到到目前为止我们已经看到的运算符，||。 具有最低的优先级，然后是&&，然后是比较运算符（>，==等），然后是其余运算符。 选择此顺序的方式是，在类似于以下表达式的典型表达式中，需要尽可能少的括号：

```javascript
1 + 1 == 2 && 10 * 10 > 50
```

我将讨论的最后一个逻辑运算符不是一元的，不是二元的，而是三元的，对三个值进行运算。 它写有问号和冒号，例如
这个：

```javascript
console.log(true ? 1 : 2);
// → 1
console.log(false ? 1 : 2);
// → 2
```

这称为条件运算符（或有时仅称为三元运算符，因为它是该语言中唯一的此类运算符）。 问号左侧的值“挑”出另外两个值中的哪个。 如果为true，则选择中间值；如果为false，则选择右边的值。

## Empty Values

有两个特殊值，分别为null和undefined，用于表示缺少有意义的值。 它们本身就是值，但它们不携带任何信息。

这种语言的许多运算符都无法产生有意义的值（您将在后面看到），只产生undefined，这仅仅是因为它们必须产生某个值。

undefined和null之间含义的差异是JavaScript设计的偶然原因，在大多数情况下都无关紧要。 如果您实际上必须关注这些值，我建议将它们视为可互换的。

## Automatic type conversion

在引言中，我提到JavaScript接受您提供的几乎所有程序，甚至是做奇怪事情的程序。 以下表达式很好地证明了这一点：

```javascript
console.log(8 * null)
// → 0
console.log("5" - 1)
// → 4
console.log("5" + 1)
// → 51
console.log("five" * 2)
// → NaN
console.log(false == 0)
// → true
```

当运算符应用于“错误”类型的值时，JavaScript会使用一组通常不是您想要或期望的规则，将该值悄悄地转换为所需的值。 这称为类型强制。 第一个表达式中的null变为0，第二个表达式中的“ 5”变为5（从字符串到数字）。 但是在第三个表达式中，+会在数字加法之前尝试字符串连接，因此1会转换为“ 1”（从数字到字符串）。

当某些没有明显地映射到数字的东西（例如“five”或undefined）转换为数字时，您将获得值NaN。 对NaN进行进一步的算术运算会继续产生NaN，因此，如果您发现其中之一处于意外位置，请查找意外的类型转换。

当使用==比较相同类型的值时，结果很容易预测：两个值相同时，除了NaN之外，您应该为真。 但是，当类型不同时，JavaScript使用一组复杂且令人困惑的规则来确定要执行的操作。 在大多数情况下，它只是尝试将一个值转换为另一个值的类型。 但是，当运算符的任意一侧出现null或undefined时，只有当双方都是null或undefined之一时，它才会产生true

```javascript
console.log(null == undefined);
// → true
console.log(null == 0);
// → false
```

这种行为通常很有用。 当您要测试某个值是否具有真实值而不是null或undefined时，可以使用==（或！=）运算符将其与null进行比较。

但是，如果您要测试某项是否指向精确值false怎么办？ 由于自动类型转换，因此0 == false和“” == false之类的表达式也为true。 当您不希望发生任何类型转换时，有两个附加的运算符：===和！==。 第一个测试一个值是否精确地等于另一个，第二个测试该值是否不精确地相等。 因此，“” === false为预期的假。

我建议防御性地使用三字符比较运算符，以防止意外的类型转换引起您的误解。 但是，当您确定双方的类型都相同时，使用较短的运算符就没有问题。

### short-circuiting of logical operators

逻辑运算符&&和|| 以一种特殊的方式处理不同类型的值。 他们将左侧的值转换为Boolean类型，以决定要做什么，但是根据运算符和该转换的结果，它们将返回原始的左侧值或右侧值。

例如，||运算符在其左侧值可以转换为true时将返回其左侧值，否则返回其右侧值。 当值是布尔值并且对其他类型的值执行类似操作时，这具有预期的效果。

```javascript
console.log(null || "user")
// → user
console.log("Agnes" || "user")
// → Agnes
```

我们可以使用此功能作为回退默认值的一种方法。 如果您的值可能为空，则可以输入||。 之后带有替换值。 如果初始值可以转换为false，那么您将获得替代值。 将字符串和数字转换为布尔值的规则规定，0，NaN和空字符串（“”）计数为false，而所有其他值计数为true。 所以0 || -1产生-1，而“” || “！？” 产生“！？” 。

&&运算符的工作原理类似，但反之亦然。 当其左侧的值转换为false时，它将返回该值，否则将返回其右侧的值。

这两个运算符的另一个重要属性是，仅在必要时才评估其右侧的零件。 如果为真|| X，无论X是什么-即使它是一个执行某些可怕操作的程序-结果都是正确的，并且X永远不会被求值。 false && X也是如此，后者为false并将忽略X。 这称为短路评估。

条件运算符的工作方式与此类似。 在第二个和第三个值中，仅评估所选的一个。

## Summary

在本章中，我们研究了四种JavaScript值类型：数字，字符串，布尔值和未定义的值。

通过键入其名称（true，null）或值（13，“ abc”）创建此类值。 您可以使用运算符组合和转换值。 我们看到了用于算术（+，-，*，/和％），字符串连接（+），比较（==，！=，===，！==，<，>，<=，> = ）和逻辑（&&，||），以及几个一元运算符（-取反数字，！进行逻辑取反，typeof查找值的类型）和三元运算符（？：）选择两个 值基于第三个值。

这为您提供了足够的信息来将JavaScript用作袖珍计算器，但仅此而已。 下一章将开始将这些表达式绑定到基本程序中。